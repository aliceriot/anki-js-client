(this.webpackJsonpkanji=this.webpackJsonpkanji||[]).push([[0],{24:function(e,n,t){},25:function(e,n,t){},28:function(e,n,t){"use strict";t.r(n);var a=t(1),r=t.n(a),c=t(9),i=t.n(c),l=(t(24),t(25),t(17)),s=t(6),o=t(29),u=t(3),j=t.n(u),d=t(7),b=t(0);function f(e){var n=e.item,t=e.label,a=e.fieldName,r=e.html;return Object(b.jsxs)("div",{className:"dialog-field",children:[Object(b.jsxs)("div",{className:"label",children:[t,":"]}),Object(b.jsx)("div",{className:"value",children:r?Object(b.jsx)("div",{dangerouslySetInnerHTML:{__html:n.fields[a].value}}):n.fields[a].value})]})}var v=t(12),h=t(13),m=t(18),O=t(16),x=t(14),g=function(e){Object(m.a)(t,e);var n=Object(O.a)(t);function t(){var e;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=n.call.apply(n,[this].concat(r))).handleClickOutside=function(n){(0,e.props.hide)()},e}return Object(h.a)(t,[{key:"render",value:function(){var e=this.props.children;return Object(b.jsx)("dialog",{open:!0,className:"item-dialog",children:e})}}]),t}(a.Component),p=Object(x.a)(g),N=function(e){var n,t,a=e>500?1:e/500;return(a*=100)<50?(n=255,t=Math.round(5.1*a)):(t=255,n=Math.round(510-5.1*a)),"#"+("000000"+(65536*n+256*t+0).toString(16)).slice(-6)};function k(e){var n=e.kanji,t=Object(a.useState)(!1),c=Object(s.a)(t,2),i=c[0],l=c[1];return n?Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)("div",{className:"kanji",onClick:function(){return l(!0)},style:{backgroundColor:n.interval_avg?N(n.interval_avg):"white"},children:n.fields.Characters.value}),i?Object(b.jsxs)(p,{hide:function(){return l(!1)},children:[Object(b.jsx)("h2",{className:"dialog-title",children:n.fields.Characters.value}),Object(b.jsx)(f,{item:n,label:"meaning",fieldName:"Meaning"}),Object(b.jsx)(f,{item:n,label:"\u97f3\u8aad\u307f",fieldName:"Reading_Onyomi",html:!0}),Object(b.jsx)(f,{item:n,label:"\u8a13\u8aad\u307f",fieldName:"Reading_Kunyomi",html:!0}),Object(b.jsx)(f,{item:n,label:"\u90e8\u9996",fieldName:"Component_Names"}),Object(b.jsx)(f,{item:n,label:"meaning mnemonic",fieldName:"Meaning_Mnemonic",html:!0}),Object(b.jsx)(f,{item:n,label:"meaning info",fieldName:"Meaning_Info",html:!0}),Object(b.jsx)(f,{item:n,label:"reading mnemonic",fieldName:"Reading_Mnemonic",html:!0}),Object(b.jsx)(f,{item:n,label:"reading info",fieldName:"Reading_Info",html:!0})]}):null]}):null}function _(e){var n=e.vocab,t=Object(a.useState)(!1),c=Object(s.a)(t,2),i=c[0],l=c[1];return n?Object(b.jsxs)(r.a.Fragment,{children:[Object(b.jsx)("div",{className:"vocab",onClick:function(){return l(!0)},style:{backgroundColor:n.interval_avg?N(n.interval_avg):"white"},children:n.fields.Characters.value},n),i?Object(b.jsxs)(p,{hide:function(){return l(!1)},children:[Object(b.jsx)("h2",{className:"dialog-title",children:n.fields.Characters.value}),Object(b.jsx)(f,{item:n,label:"meaning",fieldName:"Meaning"}),Object(b.jsx)(f,{item:n,label:"part of speech",fieldName:"Speech_Type"}),Object(b.jsx)(f,{item:n,label:"reading",fieldName:"Reading",html:!0}),Object(b.jsx)(f,{item:n,label:"\u767a\u97f3",fieldName:"Reading",html:!0}),Object(b.jsx)(f,{item:n,label:"meaning mnemonic",fieldName:"Meaning_Mnemonic",html:!0}),Object(b.jsx)(f,{item:n,label:"reading mnemonic",fieldName:"Reading_Mnemonic",html:!0}),Object(b.jsx)(f,{item:n,label:"\u65e5\u672c\u8a9e",fieldName:"Context_jp",html:!0}),Object(b.jsx)(f,{item:n,label:"\u82f1\u8a9e",fieldName:"Context_en",html:!0}),Object(b.jsx)(f,{item:n,label:"\u65e5\u672c\u8a9e",fieldName:"Context_jp_2",html:!0}),Object(b.jsx)(f,{item:n,label:"\u82f1\u8a9e",fieldName:"Context_en_2",html:!0}),Object(b.jsx)(f,{item:n,label:"\u65e5\u672c\u8a9e",fieldName:"Context_jp_3",html:!0}),Object(b.jsx)(f,{item:n,label:"\u82f1\u8a9e",fieldName:"Context_en_3",html:!0})]}):null]}):null}var w=new(t(15).a)("ankidb");w.version(1).stores({kanji:"kanji,noteId,interval_avg,level",vocab:"vocab,noteId,interval_avg,level"}),window.db=w;var y=w,C=function(e,n){return Math.floor(e/n*100)};function M(e){var n=e.level,t=Object(a.useState)(!1),r=Object(s.a)(t,2),c=r[0],i=r[1],l=Object(a.useState)(null),o=Object(s.a)(l,2),u=o[0],f=o[1],v=Object(a.useState)(null),h=Object(s.a)(v,2),m=h[0],O=h[1],x=Object(a.useState)(null),g=Object(s.a)(x,2),p=g[0],N=g[1],w=Object(a.useState)(null),M=Object(s.a)(w,2),S=M[0],I=M[1];return Object(a.useEffect)((function(){(function(){var e=Object(d.a)(j.a.mark((function e(){var t,a,r,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=17;break}return e.next=3,y.kanji.where("level").equals(n).toArray();case 3:return t=e.sent,f(t),e.next=7,y.kanji.where("level").equals(n).and((function(e){return 0!==e.interval_avg})).count();case 7:return a=e.sent,N(a),e.next=11,y.vocab.where("level").equals(n).toArray();case 11:return r=e.sent,O(r),e.next=15,y.vocab.where("level").equals(n).and((function(e){return 0!==e.interval_avg})).count();case 15:i=e.sent,I(i);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[c,n]),Object(b.jsxs)("div",{className:"level",children:[Object(b.jsxs)("div",{className:"level-header",children:[Object(b.jsx)("div",{class:"level-name",onClick:function(){return i(!c)},children:n}),c?Object(b.jsx)("div",{class:"refresh",children:"\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5"}):null]}),c?Object(b.jsxs)("div",{className:"level",children:[Object(b.jsxs)("div",{className:"sub-level-heading",children:[Object(b.jsx)("h3",{children:"\u6f22\u5b57"}),u?Object(b.jsxs)("div",{className:"num-learned",children:[p," / ",u.length]}):null]}),u?Object(b.jsx)("div",{className:"progress",children:Object(b.jsx)("div",{className:"progress-background",children:Object(b.jsx)("div",{style:{width:"".concat(C(p,u.length),"%")},className:"progress-indicator"})})}):null,u?Object(b.jsx)("div",{className:"kanjis",children:u.map((function(e){return Object(b.jsx)(k,{kanji:e},e.kanji)}))}):null,Object(b.jsxs)("div",{className:"sub-level-heading",children:[Object(b.jsx)("h3",{children:"\u8a9e\u5f59"}),m?Object(b.jsxs)("div",{className:"num-learned",children:[S," / ",m.length]}):null]}),m?Object(b.jsx)("div",{className:"progress",children:Object(b.jsx)("div",{className:"progress-background",children:Object(b.jsx)("div",{style:{width:"".concat(C(S,m.length),"%")},className:"progress-indicator"})})}):null,m?Object(b.jsx)("div",{className:"vocabs",children:m.map((function(e){return Object(b.jsx)(_,{vocab:e},e.vocab)}))}):null]}):null]})}var S=t(30),I=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{action:e,params:n,version:6}},E=function(){var e=Object(d.a)(j.a.mark((function e(n){var t,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://127.0.0.1:8765",{method:"POST",body:JSON.stringify(n)});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,r=a.result,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),R=function(){var e=Object(d.a)(j.a.mark((function e(n){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(I("findNotes",{query:"deck:".concat(n)}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),q=function(){var e=Object(d.a)(j.a.mark((function e(n){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(I("notesInfo",{notes:n}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),L=function(){var e=Object(d.a)(j.a.mark((function e(n){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(I("cardsInfo",{cards:n}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),A=function(){var e=Object(d.a)(j.a.mark((function e(n){var t,a,r,c,i,l,s,o,u,d,b;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R("\u65e5\u672c\u8a9e");case 2:return t=e.sent,e.next=5,q(t);case 5:a=e.sent,r=a.filter((function(e){return e.tags.includes("kanji")})),c=a.filter((function(e){return e.tags.includes("Vocabulary")})),n("found ".concat(r.length," kanji...")),n("found ".concat(c.length," vocab...")),i={},r.forEach((function(e){var n=e.fields.Characters.value;i[n]=e,i[n].kanji=n,i[n].level=Number(e.tags.find((function(e){return e.match("Lesson")})).replace("Lesson_",""))})),l={},c.forEach((function(e){var n=e.fields.Characters.value;l[n]=e,l[n].vocab=n,l[n].level=Number(e.tags.find((function(e){return e.match("Lesson")})).replace("Lesson_",""))})),s=r.flatMap((function(e){return e.cards})),o=c.flatMap((function(e){return e.cards})),n("fetching kanji info..."),u=0;case 18:if(!(u<=s.length)){e.next=27;break}return e.next=21,L(s.slice(u,u+500));case 21:d=e.sent,n("".concat(Math.floor(u/s.length*100),"%")),d.forEach((function(e){var n=i[e.fields.Characters.value];n?(n.interval?n.interval.push(e.interval):n.interval=[e.interval],n.interval_avg=Object(S.a)(n.interval)):(console.log(e),console.log("didnt find this kanji for some reason"))}));case 24:u+=500,e.next=18;break;case 27:y.kanji.bulkPut(Object.values(i)),n("fetching vocab info..."),u=0;case 30:if(!(u<=o.length)){e.next=39;break}return e.next=33,L(o.slice(u,u+500));case 33:b=e.sent,n("".concat(Math.floor(u/o.length*100),"%")),b.forEach((function(e){var n=l[e.fields.Characters.value];n?(n.interval?n.interval.push(e.interval):n.interval=[e.interval],n.interval_avg=Object(S.a)(n.interval)):(console.log(e),console.log("didnt find this vocab for some reason"))}));case 36:u+=500,e.next=30;break;case 39:n("done!"),y.vocab.bulkPut(Object.values(l));case 41:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),J=Object(o.a)((function(e){return e+1}),60);function P(){var e=Object(a.useState)(!1),n=Object(s.a)(e,2),t=n[0],r=n[1],c=Object(a.useState)(["fetching data..."]),i=Object(s.a)(c,2),o=i[0],u=i[1];return Object(a.useEffect)((function(){A((function(e){return u((function(n){return[].concat(Object(l.a)(n),[e])}))})).then((function(){r(!0)}))}),[]),Object(b.jsx)("div",{className:"App",children:t?Object(b.jsx)("div",{className:"item-list",children:J.map((function(e){return Object(b.jsx)(M,{level:e},e)}))}):Object(b.jsx)("div",{className:"data-fetch-log",children:o.map((function(e){return Object(b.jsxs)("span",{children:[e,Object(b.jsx)("br",{})]})}))})})}function T(){return Object(b.jsx)(P,{})}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(b.jsx)(T,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[28,1,2]]]);
//# sourceMappingURL=main.9aee22e3.chunk.js.map